---
import { EmbedHydrator } from '@components/embed/EmbedHydrator';
import type { ContentConfig } from '@constants/content-config';
import { defaultContentConfig } from '@constants/content-config';
import type { AstroComponentFactory } from 'astro/runtime/server/index.js';
import { christmasConfig } from '@/constants/site-config';

interface Props {
  Content: AstroComponentFactory;
  config?: Partial<ContentConfig>;
}

const { Content, config = {} } = Astro.props;
const finalConfig = { ...defaultContentConfig, ...config };
---

<div
  class:list={['custom-content', { 'relative z-5': christmasConfig.enabled && christmasConfig.features.snowfall }]}
  data-config={JSON.stringify(finalConfig)}
>
  <Content />
</div>

{/* Only load EmbedHydrator if tweet embeds are enabled (link previews are now server-rendered) */}
{finalConfig.enableTweetEmbed && <EmbedHydrator client:load />}

<script>
  import { initContentEnhancer } from '@lib/content-enhancer';
  initContentEnhancer();
</script>
